<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI Archive - ì—…ë¡œë“œ</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* ì—…ë¡œë“œ í˜ì´ì§€ ìŠ¤íƒ€ì¼ (ë„¤ ì‚¬ì´íŠ¸ í†¤ ìœ ì§€) */

    .upload-container {
      margin-top: 130px;
      max-width: 700px;
      background: #141414;
      padding: 40px;
      margin-left: auto;
      margin-right: auto;
      border-radius: 12px;
      border: 1px solid #333;
      box-shadow: 0 0 20px rgba(0,255,255,0.15);
    }

    .upload-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 25px;
      text-align: center;
    }

    .type-tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      gap: 10px;
    }

    .tab-btn {
      padding: 10px 18px;
      border: 1px solid #444;
      background: #111;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }

    .tab-btn.active {
      background: #0ff;
      color: #000;
      font-weight: 700;
      box-shadow: 0 0 10px #0ff;
    }

    .upload-box {
      margin-top: 20px;
      border: 2px dashed #555;
      padding: 40px;
      text-align: center;
      border-radius: 10px;
      background: #1b1b1b;
      cursor: pointer;
      transition: 0.2s;
    }

    .upload-box:hover {
      border-color: #0ff;
      box-shadow: 0 0 15px #0ff;
    }

    .file-name {
      margin-top: 15px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }

    .progress-bar {
      margin-top: 15px;
      width: 100%;
      height: 10px;
      background: #333;
      border-radius: 5px;
      overflow: hidden;
    }

    .progress-fill {
      width: 0%;
      height: 100%;
      background: #0ff;
      transition: 0.1s;
    }

    .upload-btn {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      background: #0ff;
      color: #000;
      font-weight: 700;
      cursor: pointer;
      font-size: 16px;
    }

    .upload-btn:hover {
      box-shadow: 0 0 10px #0ff;
    }

    .result-link {
      margin-top: 20px;
      padding: 12px;
      background: #111;
      text-align: center;
      border: 1px solid #333;
      border-radius: 8px;
      word-break: break-all;
    }
  </style>
</head>

<body>

  <!-- í—¤ë” -->
  <header class="header">
    <a href="index.html">
      <div class="header-left neon-title">AI Archive</div>
    </a>

    <div class="header-center">
      <input type="text" placeholder="ê²€ìƒ‰..." class="search-box" />
    </div>

    <div class="header-right">
      <!-- <a href="login.html"><button class="btn">ë¡œê·¸ì¸</button></a> -->
      <!-- <a href="join.html"><button class="btn">íšŒì›ê°€ì…</button></a> -->
      <a href="profile.html"><button class="btn">ğŸƒ</button></a>
      <div class="profile-icon">ğŸ‘¤</div>
    </div>
  </header>
  

  <!-- ì—…ë¡œë“œ UI -->
  <div class="upload-container">

    <div class="upload-title">ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</div>

    <!-- ì—…ë¡œë“œ íƒ€ì… ì„ íƒ -->
    <div class="type-tabs">
      <button class="tab-btn active" id="tab-image">ì´ë¯¸ì§€ ì—…ë¡œë“œ</button>
      <button class="tab-btn" id="tab-video">ì˜ìƒ ì—…ë¡œë“œ</button>
    </div>

    <!-- íŒŒì¼ ì„ íƒ ì˜ì—­ -->
    <div class="upload-box" id="uploadBox">
      í´ë¦­ ë˜ëŠ” íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”
      <input type="file" id="fileInput" style="display:none;">
    </div>

    <div class="file-name" id="fileName">ì„ íƒëœ íŒŒì¼ ì—†ìŒ</div>

    <!-- ì§„í–‰ë¥  -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <button class="upload-btn" id="uploadBtn">ì—…ë¡œë“œí•˜ê¸°</button>

    <div class="result-link" id="resultLink" style="display:none;"></div>

  </div>


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>

<!-- Firebase ì„¤ì • (ë„¤ í”„ë¡œì íŠ¸ìš©ìœ¼ë¡œ ë°”ê¿”ì¤˜) -->
<script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "YOUR_MSG_ID",
    appId: "YOUR_APP_ID"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const storage = firebase.storage();
</script>


<script>
let uploadType = "image"; // ê¸°ë³¸ê°’: ì´ë¯¸ì§€
const fileInput = document.getElementById("fileInput");
const uploadBox = document.getElementById("uploadBox");
const fileNameText = document.getElementById("fileName");
const progressFill = document.getElementById("progressFill");
const resultLink = document.getElementById("resultLink");

/* ---------- íƒ­ ë³€ê²½ ---------- */
document.getElementById("tab-image").onclick = () => setType("image");
document.getElementById("tab-video").onclick = () => setType("video");

function setType(type) {
    uploadType = type;

    document.getElementById("tab-image").classList.remove("active");
    document.getElementById("tab-video").classList.remove("active");

    if (type === "image") document.getElementById("tab-image").classList.add("active");
    else document.getElementById("tab-video").classList.add("active");
}

/* ---------- íŒŒì¼ ì„ íƒ ---------- */
uploadBox.onclick = () => fileInput.click();

fileInput.onchange = () => {
  const file = fileInput.files[0];
  if (file) validateFile(file);
};

uploadBox.addEventListener("dragover", e => {
  e.preventDefault();
  uploadBox.style.borderColor = "#0ff";
});

uploadBox.addEventListener("dragleave", e => {
  uploadBox.style.borderColor = "#555";
});

uploadBox.addEventListener("drop", e => {
  e.preventDefault();
  uploadBox.style.borderColor = "#555";

  const file = e.dataTransfer.files[0];
  if (file) validateFile(file);
});

/* ---------- íŒŒì¼ ê²€ì¦ ---------- */
function validateFile(file) {
  const imageExt = ["jpg", "jpeg", "png", "webp"];
  const videoExt = ["mp4", "mov", "webm"];

  const ext = file.name.split(".").pop().toLowerCase();

  if (uploadType === "image" && !imageExt.includes(ext)) {
    alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    fileInput.value = "";
    return;
  }

  if (uploadType === "video" && !videoExt.includes(ext)) {
    alert("ì˜ìƒ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    fileInput.value = "";
    return;
  }

  fileNameText.innerText = file.name;
}

/* ---------- Firebase ì—…ë¡œë“œ ---------- */
document.getElementById("uploadBtn").onclick = () => {
  const file = fileInput.files[0];
  if (!file) {
    alert("íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”!");
    return;
  }

  const filePath =
    uploadType === "image"
      ? `images/${Date.now()}_${file.name}`
      : `videos/${Date.now()}_${file.name}`;

  const storageRef = storage.ref(filePath);
  const uploadTask = storageRef.put(file);

  uploadTask.on(
    "state_changed",
    snapshot => {
      const percent = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
      progressFill.style.width = percent + "%";
    },
    error => {
      alert("ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
    },
    () => {
      uploadTask.snapshot.ref.getDownloadURL().then(url => {
        resultLink.style.display = "block";
        resultLink.innerText = url;
      });
    }
  );
};
</script>

</body>
</html>
